repeat task.wait() until game:IsLoaded() and game.Players.LocalPlayer
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local playerGui = LocalPlayer:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "HuneUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local Frame = Instance.new("Frame")
Frame.BackgroundColor3 = Color3.new(0.278, 0.278, 0.278)
Frame.BackgroundTransparency = 0.5
Frame.BorderSizePixel = 0
Frame.Position = UDim2.new(0.1, 0, 0.05, 0)
Frame.Size = UDim2.new(0, 799, 0, 95)
Frame.Parent = screenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 25)
UICorner.Parent = Frame

local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Color3.new(0.21, 1, 0.15)
UIStroke.Thickness = 5
UIStroke.Parent = Frame

local Title = Instance.new("TextLabel")
Title.Font = Enum.Font.SourceSansBold
Title.Text = "HuneIPA - BLOX FRUIT KAITUN SCRIPT"
Title.TextColor3 = Color3.new(0.05, 1, 0.05)
Title.TextSize = 30
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0.38, 0, -0.08, 0)
Title.Size = UDim2.new(0, 400, 0, 50)
Title.Name = "Title"
Title.Parent = Frame

local Status = Instance.new("TextLabel")
Status.Font = Enum.Font.SourceSansBold
Status.Text = "Idle"
Status.TextColor3 = Color3.new(0.05, 1, 0.05)
Status.TextSize = 50
Status.BackgroundTransparency = 1
Status.Position = UDim2.new(0.1, 0, 0.3, 0)
Status.Size = UDim2.new(0, 635, 0, 50)
Status.Name = "Status"
Status.Parent = Frame

local function SetStatus(txt, color)
    Status.Text = txt
    if color then
        Status.TextColor3 = color
    end
end

local function IsEntityAlive(entity)
    if not entity then return false end
    local humanoid = entity:FindFirstChild("Humanoid")
    return humanoid and humanoid.Health > 0
end

local function SafeHRP()
    return LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
end

local function SafeQuestVisible()
    local main = LocalPlayer.PlayerGui:FindFirstChild("Main")
    local quest = main and main:FindFirstChild("Quest")
    return quest and quest.Visible or false
end

local noclipConn
local function EnableNoClip()
    if noclipConn then return end
    noclipConn = RunService.Stepped:Connect(function()
        local ch = LocalPlayer.Character
        if not ch then return end
        for _,p in ipairs(ch:GetDescendants()) do
            if p:IsA("BasePart") then p.CanCollide = false end
        end
    end)
end
local function DisableNoClip()
    if noclipConn then noclipConn:Disconnect() noclipConn = nil end
end

local function MoveAbove(enemy)
    local hrp = SafeHRP()
    if not hrp then return end
    if not enemy or not enemy.Parent then return end
    local targetHRP = enemy:FindFirstChild("HumanoidRootPart")
    if not targetHRP then return end
    hrp.CanCollide = false
    local targetPos = targetHRP.Position + Vector3.new(0,15,0)
    local dist = (hrp.Position - targetPos).Magnitude
    local duration = dist/300
    local goal = CFrame.new(targetPos, targetHRP.Position)
    local tw = TweenService:Create(hrp, TweenInfo.new(duration, Enum.EasingStyle.Linear), {CFrame = goal})
    tw:Play()
end

local function GetEnemiesInRange(character, range)
    local enemies = Workspace.Enemies:GetChildren()
    local players = Players:GetPlayers()
    local targets = {}
    local playerPos = character:GetPivot().Position
    for _, enemy in ipairs(enemies) do
        local rootPart = enemy:FindFirstChild("HumanoidRootPart")
        if rootPart and IsEntityAlive(enemy) then
            local distance = (rootPart.Position - playerPos).Magnitude
            if distance <= range then
                table.insert(targets, enemy)
            end
        end
    end
    for _, otherPlayer in ipairs(players) do
        if otherPlayer ~= LocalPlayer and otherPlayer.Character then
            local rootPart = otherPlayer.Character:FindFirstChild("HumanoidRootPart")
            if rootPart and IsEntityAlive(otherPlayer.Character) then
                local distance = (rootPart.Position - playerPos).Magnitude
                if distance <= range then
                    table.insert(targets, otherPlayer.Character)
                end
            end
        end
    end
    return targets
end

function AttackNoCoolDown()
    local character = LocalPlayer.Character
    if not character then return end
    local equippedWeapon
    for _, item in ipairs(character:GetChildren()) do
        if item:IsA("Tool") then
            equippedWeapon = item
            break
        end
    end
    if not equippedWeapon then return end
    local enemiesInRange = GetEnemiesInRange(character, 60)
    if equippedWeapon:FindFirstChild("LeftClickRemote") then
        local attackCount = 1
        for _, enemy in ipairs(enemiesInRange) do
            if enemy and enemy.Parent and enemy:FindFirstChild("HumanoidRootPart") then
                local direction = (enemy.HumanoidRootPart.Position - character:GetPivot().Position).Unit
                pcall(function()
                    equippedWeapon.LeftClickRemote:FireServer(direction, attackCount)
                end)
                attackCount = attackCount + 1
            end
        end
    else
        local targets, mainTarget = {}, nil
        for _, enemy in ipairs(enemiesInRange) do
            if enemy and enemy.Parent and not enemy:GetAttribute("IsBoat") then
                local head = enemy:FindFirstChild("Head")
                if head then
                    table.insert(targets, { enemy, head })
                    mainTarget = head
                end
            end
        end
        if mainTarget then
            local attackEvent = ReplicatedStorage.Modules.Net.RE.RegisterAttack
            local hitEvent = ReplicatedStorage.Modules.Net.RE.RegisterHit
            if attackEvent and hitEvent then
                pcall(function()
                    attackEvent:FireServer(0.1)
                    hitEvent:FireServer(mainTarget, targets)
                end)
            end
        end
    end
end

local worldMap = {
    [2753915549] = true,
    [4442272183] = true,
    [7449423635] = true
}
local placeId = game.PlaceId
local World1

if worldMap[placeId] then
    if placeId == 2753915549 then
        World1 = true
    end
end

function AutoStatMelee()
    return true
end

spawn(function()
    while wait() do
        if AutoStatMelee() then
            local v741 = { [1] = "AddPoint", [2] = "Melee", [3] = 3 }
            pcall(function()
                ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(v741))
            end)
        end
    end
end)

function JoinPirates()
    pcall(function()
        ReplicatedStorage.Remotes.CommF_:InvokeServer("SetTeam", "Pirates")
    end)
end

local code = {
    "WildDares","BossBuild","GetPranked","Sub2OfficialNoobie","Sub2Daigrock",
    "Sub2NoobMaster123","Bluxxy","JCWK","Enyu_is_Pro","Sub2Fer999","kittgaming",
    "TheGreatAce","StrawHatMaine","TantaiGaming","Axiore","SUB2GAMERROBOT_EXP1",
    "MagicBus","StarcodeHEO","Sub2CaptainMaui","FIGHT4FRUIT","EARN_FRUITS"
}
function RedeemCode(Value)
    pcall(function()
        ReplicatedStorage.Remotes.Redeem:InvokeServer(Value)
    end)
end

local function NameStartsWith(entityName, base)
    if type(entityName) ~= "string" or type(base) ~= "string" then return false end
    local s = string.sub(entityName, 1, #base)
    return s == base
end

local function NearestEnemyByPrefix(prefix)
    local hrp = SafeHRP()
    if not hrp then return nil end
    local nearest, dist = nil, 1/0
    for _,e in ipairs(Workspace.Enemies:GetChildren()) do
        if IsEntityAlive(e) and NameStartsWith(e.Name, prefix) and e:FindFirstChild("HumanoidRootPart") then
            local d = (e.HumanoidRootPart.Position - hrp.Position).Magnitude
            if d < dist then nearest = e dist = d end
        end
    end
    return nearest
end

function FarmBandit()
    if not World1 then return end
    EnableNoClip()
    local MyLevel = LocalPlayer.Data.Level.Value
    while MyLevel < 10 do
        SetStatus("Farming Bandit", Color3.new(1,0,0))
        if not SafeQuestVisible() then
            local chrp = SafeHRP()
            if chrp then
                LocalPlayer.Character:PivotTo(CFrame.new(1059.37195,15.4495068,1550.4231))
            end
            task.wait(1)
            pcall(function()
                ReplicatedStorage.Remotes.CommF_:InvokeServer("StartQuest","BanditQuest1",1)
            end)
            task.wait(1)
        else
            local target = NearestEnemyByPrefix("Bandit")
            if target then
                repeat
                    if not IsEntityAlive(target) or not target:FindFirstChild("HumanoidRootPart") then break end
                    task.wait(0.05)
                    MoveAbove(target)
                    AttackNoCoolDown()
                    MyLevel = LocalPlayer.Data.Level.Value
                until not IsEntityAlive(target) or MyLevel >= 10
            else
                task.wait(0.2)
            end
        end
        MyLevel = LocalPlayer.Data.Level.Value
        task.wait(0.1)
    end
    DisableNoClip()
end

function FarmGodGuard()
    if not World1 then return end
    EnableNoClip()
    local MyLevel = LocalPlayer.Data.Level.Value
    while MyLevel >= 10 and MyLevel <= 65 do
        SetStatus("Farming God's Guard", Color3.new(1,0,0))
        local h = SafeHRP()
        if h and (h.Position-Vector3.new(-4721.88867,843.874695,-1949.96643)).Magnitude > 10000 then
            pcall(function()
                ReplicatedStorage.Remotes.CommF_:InvokeServer("requestEntrance", Vector3.new(-4607.82275,872.54248,-1667.55688))
            end)
        end
        local target = NearestEnemyByPrefix("God's Guard")
        if target then
            repeat
                if not IsEntityAlive(target) or not target:FindFirstChild("HumanoidRootPart") then break end
                task.wait(0.05)
                MoveAbove(target)
                AttackNoCoolDown()
                MyLevel = LocalPlayer.Data.Level.Value
            until not IsEntityAlive(target) or MyLevel > 65
        else
            task.wait(0.2)
        end
        MyLevel = LocalPlayer.Data.Level.Value
        task.wait(0.1)
    end
    DisableNoClip()
end

getgenv().AUTOHAKI = true
spawn(function()
    local canUseHaki = true
    local debounceTime = 2
    while task.wait(0.1) do
        if getgenv().AUTOHAKI then
            if not (LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HasBuso")) and canUseHaki then
                canUseHaki = false
                local args = { [1] = "Buso" }
                pcall(function()
                    ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(args))
                end)
                wait(debounceTime)
                canUseHaki = true
            end
        end
    end
end)

local isRedeeming = true
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    if getgenv().AUTOHAKI then
        pcall(function()
            ReplicatedStorage.Remotes.CommF_:InvokeServer("Buso")
        end)
    end
    if not isRedeeming then
        local lv = LocalPlayer.Data.Level.Value
        if lv < 10 then
            spawn(FarmBandit)
        elseif lv >= 10 and lv <= 65 then
            spawn(FarmGodGuard)
        end
    end
end)

spawn(function()
    JoinPirates()
    task.wait(0.5)
    for i,v in pairs(code) do
        SetStatus("Redeem Code...", Color3.new(0,1,1))
        RedeemCode(v)
        wait(0.15)
    end
    isRedeeming = false
    SetStatus("Idle", Color3.new(0.05,1,0.05))
    task.wait(0.5)
    FarmBandit()
    FarmGodGuard()
    SetStatus("Idle", Color3.new(0.05,1,0.05))
end)
